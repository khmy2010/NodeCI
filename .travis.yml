language: node_js
node_js:
- '8'
dist: trusty
services:
- mongodb
- redis-server
env:
  matrix:
  - NODE_ENV=ci PORT=3000
  global:
  - secure: czG7BZ4SdvyOMwGyqCT6dssAGJ6GxFy+nzNLpTmcRCN+XZZRF1S10QS5Cr8THZMs4gih8rQc617flvPH6DDnuSWQJd1ozZEABb52kiTUMDzgbbWjMQLREgifuOLOvhg+on0fYY00TO9C7sTFWn9/fzACMrSelYh8u2PJJsnTq4o4WWRWMch3svNVK+AWCY9QbYsvYQZDHqYugn9f5ZzvLP8eHENvzDcqGjYtutyiLYl62gLplCGZki5iqnQ3u9KFPfF8/rp5TqbZGZcJe6U0Dkt8sU6xEwyAUW17NTwaEX/ZMBDib+Kpm0ygVV+V3C888muGW2CxmP2Ck5n/hkLh956Xloi5uogZJi8Js+wBZNrNq/04NYzaYp6pFXGgzwwxx1EC9ecYtMld0mOkp44Gf01fQJNPPYzExEGKtPzZ6K71Zn34F0wdUQa/CIrq7X2w1bnBpvq+tu3qbw+e5Xty8RURKkuCNjs95UpMqf5BCDLX1DTjvF3kbsR5Uo9tvCfjsHFzjUVL5CSJ5ofo0c7sMASyKAK0f8E2WBn2Jay2OkghcY8djDsTr4gHbe/Z/H5WxWM2mTbEb/VnHcmSs7WjMGvDndfV1tBQneUvBye7LwtOSylylsRm7q21/3HGCf4/mfy6qPtNFTB405SzIlm6KK70ZbjuCYL24iBz862/2JI=
  - secure: M/fNUOO2N4iXL51NdIMO9NiY6Jpqc8cEc2L5qLyesa4D7jzJfvR94O8VLhWxiqKJxom9fITJu9GcOaewRuYvLb1JbJAdlXQXRb1cUK5yXwNd0A1hYHXfNcZGwUToc70eMBlH/8ZAAYNInUKuvPZS2ICpQDggse8/or5d5iIdF8KzIF7CQfp5SUgUHVJcEKBp5GBfE+gdWsmLPRM6X4z2O9QGLo6CvyRJ2num6ZpB4xhO3XdxlMnoQLEVTXdewNk0hEEw14huvYztzx4jsQNOmQTyeLNzgRB9cvaNwcm9+8gaMNJiih2j3Z7tgxAspn+DhPXuCzS2b5lO7epKSvvMmQLqOm/pW7AwX29+GFQ0GXc/kwofta0AH14t0LESBz5pioC+E8toikC7kcqIN9NldUQ9EE2CveUMlzfJeX23wo6i/Q8BaMgNXMNLRU3vgEfHo9DcisrP6tEKeMj98o+s9CWI+YyDQqbwZjEm5CtHtKpU9+6Z4dhiAdApqnO5QAMNUQINMGY6dl/rNAu/2mrokUZYJF8gcgAz84wNDn11FvLmTu0Qzj93BHJRpgu5N4i6RV0cXO6tAxGmi2JUolcjYK+tBA8dpytR5QTg2L+7TL2PLQNhgeOuGG0HML7Iwa0yQzvk+pFJSVyX7dJIo8uqlgO1bM/apmky3p2vW7FIDdM=
  - secure: U0tbos4TQ/c+mfipH+VV4NrTPMTGUYmorA0TK0EQtj0/XOH8HwmLcsYK984jP/A5+c6Sgn669+ASt+Ue8yd3SEPTWQ/+aF68WiYBLDZ/3m6iNJ3Gzh+DTUcgZD8cPZlR5EDMlKRxoC2V0bxT8NzlQfapZy58bZyIxMBrRkVd6pDcC7cxuzsxrSoMxgADMHdDcPo31RAp3UXzr5xp5ovjpEITb6Jq6/zTTEH8ceNObbrXug1zd/42zfsYd9NuHrvmSqLdEhFFRoNAQ8Hc5BmsVcsfXe7bboa8WwX5XyWbMk9mWWSJrG/Ki8zc8ZHtpduQailwyY2ysxuLmdGufWvh4eAYCvmdg0F43/uCAUVum6pN2cIpsDXO7KJv8yVz5Ji1Uqb/XDbj8F++gw9A/DDB9eM1uzH+mi1zcl4/H+DXebTAnu6rN3MbJPh4zI4MPPQtB3ohqjpJ9thoYd31uEy9cEORQix/vgkdX5lSDIfWNdd4WNdsMGK+CU+UWVvdBHvThL7gq9XNUksywJbt73RhcaVa3Ogq+uqvbC3lk3Xwmqo8Tqe8dMFnqsw+XkWUrbPKAiQat6KVZv9HRheRkK2NPCIm7jiUaHou/FmuW4jkxCfswKerUJGrFRbWIYrlKE5QJx1vfHjDmkVEKqtXkOjLvWYCx9BJf0hce47RzGcot6Y=
  - secure: m5yLZ1J99OP0yiRVtkk9gomtmdQ48Ap2aF5f9nSXjV5YHZ00nSpkAHhfOmPiogrpx8LHHnHS6FECYWidatDMqg1xAfBlFXxUiznasfzvXkYdq8vJ9ZV7yPLUkj5Fn/39Yn9XJVXCmGRbj6H7wsaGN9ckGl11YDxfXLbrRYgsAGampPX7e15Az/ZZKnf5o2zAOnvqgWjyzOyfPf5jRqlWf/6N/OLm6VFu5jGy8jAcaIoyLFnqPKZ0LBZkmto91IeoXatsqeTEmOfV466cM0iVBHgX5azSZXCyUHVwwrD03ClpghbJd+k54P2EDgdttywrgTqNY9fKY/I0Hxl4nR3aAsO36s6N7GgBXFd6+kq76au/h0JXV9lSI0e69gLqep08wGsw4A24SXkR/BUwcR+0Iyx2DboJHEe9y6EEk4YNwKoQ5EaJ686X9BgtqVRKYGr9GRpviF60e4Ce7mP682JlaRAZYbH9dHHjlYAkDlKSzS+r9yZadFZXZV1om+TrlutL/f3KOkgjw4RZdc9YQwcKfPfVWUUsoD/AG67FN1doltEQzVTd87JgWbe2W4YRVegM6R05N3txc1MYv3zJGSFIvH9TCftt5R7mw3vqhVP/2U8QqdHYetfgJuUedZP4xiOAkzO3afF1tS/umzMNyYlp5B23sUoKllbQ9KYntjCKYko=
  - secure: Sry87K2jiJdb/0OGUEgjAIryvWVWxxNtE7wRe6/Xg/PGPWIzbWXgkk2KLHPLeu3TbfypWwsEvRZJoOhgXKA1VMNkwnJWsSZBJotQoDepRjLiNrTaWfxPRgaC9+iirpoylAnPjxH+hclCVjoEVZJznosEJnYMMO56X3fdhJZkh03skQENGZQ3ZZrBee3lR4Q+Adm3p9S9TgBJYpW1TUCzK+Zzhc7Byp3Z3yEzmLREQ6tsuDlRi3L5GALQbmmEDWh+fSf8WvZ1BRYLMgS+OWIPe0uaGJHDUiJmusOJqJYS2HiT+PFMsV3797s3Co7/0WcN/rWrbVtL0tVY37KcFTE/Ze4n8jlMxwsHUg0DZw6dGkYb5FIZQWJfJfUgypn4u6hbiV4NNFLY78/dspXQ6SJq/BMUzHtEdsBpeIUp8qYnVW6ZgOJsAr1gV5VqZ9r31pkiwxAwCojcVbVtja14f+FBlU25UzOSyf9PgRIWdu0E2Y13WkF78dHVw9jnPz6uSJWpuGArX9nbcBm1yEKjNQQ+pXsLIU7IRuh4eaNTVua5VHXzyo535FHMgNCOxoFwlb3FbbQsiXaXNdduBGGlgunPLxJDsb+6Gmd8/Z4cb6dgGvsxZuUzIsM4hxZgJ1sibcK6X72AcNn88VEEYYL36NcszReRlpiMi7jrMfCDZGbLJUY=
cache:
  directories:
  - node_modules
  - client/node_modules
install:
- npm install
- npm run build
script:
- nohup npm run start &
- sleep 3
- npm run test
